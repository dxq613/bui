/*! BUI - v0.1.0 - 2013-11-18
* https://github.com/dxq613/bui
* Copyright (c) 2013 dxq613; Licensed MIT */
define("bui/picker",["bui/common","bui/picker/picker","bui/picker/listpicker"],function(a){var b=a("bui/common"),c=b.namespace("Picker");return b.mix(c,{Picker:a("bui/picker/picker"),ListPicker:a("bui/picker/listpicker")}),c}),define("bui/picker/picker",["bui/overlay"],function(a){var b=a("bui/overlay").Overlay,c=b.extend({bindUI:function(){var a=this,b=(a.get("hideEvent"),$(a.get("trigger")));b.on(a.get("triggerEvent"),function(){if(a.get("isInit")||a._initControl(),a.get("autoSetValue")){var b=a.get("valueField")||a.get("textField")||this,c=$(b).val();a.setSelectedValue(c)}})},_initControl:function(){var a=this;if(!a.get("isInit")){if(!a.get("innerControl")){var b=a.createControl();a.get("children").push(b)}a.initControlEvent(),a.set("isInit",!0)}},createControl:function(){},initControlEvent:function(){var a=this,b=a.get("innerControl"),c=$(a.get("trigger")),d=a.get("hideEvent");b.on(a.get("changeEvent"),function(b){var d=a.get("curTrigger"),e=a.get("textField")||d||c,f=a.get("valueField"),g=a.getSelectedValue(),h=!1;if(e){var i=a.getSelectedText(),j=$(e).val();i!=j&&($(e).val(i),h=!0,$(e).trigger("change"))}if(f){var k=$(f).val();f!=k&&($(f).val(g),h=!0,$(f).trigger("change"))}h&&a.onChange(i,g,b)}),d&&b.on(a.get("hideEvent"),function(){var b=a.get("curTrigger");try{b&&b.focus()}catch(c){BUI.log(c)}a.hide()})},setSelectedValue:function(){},getSelectedValue:function(){},getSelectedText:function(){},focus:function(){this.get("innerControl").focus()},onChange:function(a,b){var c=this,d=c.get("curTrigger");c.fire("selectedchange",{value:b,text:a,curTrigger:d})},handleNavEsc:function(){this.hide()},_uiSetValueField:function(a){var b=this;a&&b.setSelectedValue($(a).val())},_getTextField:function(){var a=this;return a.get("textField")||a.get("curTrigger")}},{ATTRS:{innerControl:{getter:function(){return this.get("children")[0]}},triggerEvent:{value:"click"},autoSetValue:{value:!0},changeEvent:{value:"selectedchange"},autoHide:{value:!0},hideEvent:{value:"itemclick"},textField:{},align:{value:{points:["bl","tl"],offset:[0,0]}},valueField:{}}},{xclass:"picker"});return c}),define("bui/picker/listpicker",["bui/picker/picker","bui/list"],function(a){var b=(a("bui/list"),a("bui/picker/picker")),c=b.extend({initializer:function(){var a=this,b=a.get("children"),c=a.get("list");c||b.push({})},setSelectedValue:function(a){a=a?a.toString():"",this.get("isInit")||this._initControl();var b=this,c=b.get("list"),d=b.getSelectedValue();a!==d&&c.getCount()&&(c.get("multipleSelect")&&c.clearSelection(),c.setSelectionByField(a.split(",")))},onChange:function(a,b,c){var d=this,e=d.get("curTrigger");d.fire("selectedchange",{value:b,text:a,curTrigger:e,item:c.item})},getSelectedValue:function(){return this.get("isInit")||this._initControl(),this.get("list").getSelectionValues().join(",")},getSelectedText:function(){return this.get("isInit")||this._initControl(),this.get("list").getSelectionText().join(",")}},{ATTRS:{defaultChildClass:{value:"simple-list"},list:{getter:function(){return this.get("children")[0]}}}},{xclass:"list-picker"});return c});