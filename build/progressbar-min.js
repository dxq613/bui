/*! BUI - v0.1.0 - 2013-11-18
* https://github.com/dxq613/bui
* Copyright (c) 2013 dxq613; Licensed MIT */
define("bui/progressbar",["bui/common","bui/progressbar/base","bui/progressbar/load"],function(a){var b=a("bui/common"),c=b.namespace("ProgressBar");return b.mix(c,{Base:a("bui/progressbar/base"),Load:a("bui/progressbar/load")}),c}),define("bui/progressbar/base",["bui/common"],function(a){var b=a("bui/common"),c=b.Component.View.extend({_uiSetPercent:function(a){var c=this,d=c.get("el").children();b.isArray(a)||(a=[a]),b.each(d,function(b,c){$(b).width(a[c]+"%")})}},{ATTRS:{percent:{}}}),d=b.Component.Controller.extend({},{ATTRS:{percent:{view:!0,value:0},tpl:{value:'<div class="progress-bar-inner"></div>'},xview:{value:c}}},{xclass:"progress-bar"});return d}),define("bui/progressbar/load",["bui/progressbar/base"],function(a){var b=a("bui/progressbar/base"),c=0,d=1,e=2,f=b.extend({bindUI:function(){var a=this;a.on("afterPercentChange",function(){if(a.isLoading()){var b=a.get("percent");100==b&&a.onCompleted(),a.onChange()}})},start:function(){var a=this;a.isLoading()||a.onstart()},complete:function(){var a=this;clearTimeout(a.get("t")),a.set("percent",100)},cancel:function(){var a=this;clearTimeout(a.get("t")),a.get("percent")&&a.set("percent",0),a.set("status",c)},onstart:function(){var a=this,b=a.get("cfg");a.set("percent",0),a.set("status",d),a.fire("start",b),a._startLoad()},onChange:function(){var a=this;a.fire("loadchange")},onCompleted:function(){var a=this;a.set("status",e),a.fire("completed")},isLoading:function(){return this.get("status")===d},isCompleted:function(){return this.get("status")===e},_startLoad:function(){var a,b=this,c=b.get("ajaxCfg"),d=b.get("interval");c.success=function(e){var f=e.percent;b.set("percent",f),100>f&&b.isLoading()&&(a=setTimeout(function(){$.ajax(c)},d),b.set("t",a))},$.ajax(c)}},{ATTRS:{status:{value:0},ajaxCfg:{},interval:{value:500},events:{value:["start","loadchange","completed"]}}},{xclass:"progress-bar-load"});return f});